# CPM_fuzzy_measure

Framework to execute experiments for aggregating ensemble matrices using differents methods including the proposed **CPM fuzzy measure**.

Usage: `python main.py --config-file config.txt`

We have to provide a config file indicating all training and test data (with confidence matrices generated by ensemble), the number of classifiers to use, the aggregation method (with its required parameters) and where store the predictions.

## Config file
```
train_data=train.dat
train_conf=train_conf.txt
train_out=train_out.txt
test_data=test.dat
test_conf=test_conf.txt
test_out=test_out.txt
train_pred=train_pred_out.csv
test_pred=test_pred_out.csv
method=AM
num_classifiers=10
score=gm
```

Data files (`train.dat` and `test.dat`) must follow the [keel](http://keel.es/) data format.

Confidence files (`train_conf.txt` and `test_conf.txt`) are files where each line of the file are the classifier outputs (confidences) separated by tab (`\t`). **The current version is prepared for binary datasets, so the confidence value indicates the probability of being of class 1**

Output files (`train_out.txt` and `test_out.txt`) are files where each line of the file are the classifier outputs (classes) separated by tab (\t)

Predictions are stored in CSV format (`train_pred_out.csv` and `test_pred_out.csv`) with two columns: `target` and `prediction`

`num_classifiers`: How many classifier to use. It will select the first `num_classifiers`

`method` is the aggregation method to use. Available methods:
- **AM**: Arithmetic Mean
- **MED**: Median
- **GM**: Geometric Mean
- **HM**: Harmonic Mean
- **MIN**: Minimum
- **MAX**: Maximum
- **WAM**: Weighted Arithmetic Mean. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
- **Qalh**: OWA of (a)t (l)east (h)alf
- **Qamap**: OWA of (a)s (m)any (a)s (p)ossible
- **Qmot**: OWA of (m)ost (o)f (t)hem
- **Cm**: Choquet integral with CPM fuzzy measure. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
  - *pre_agg_function*: pre aggregation function to use. It can be 'prod' (default), 'min' or 'max'
- **Cm+**: Choquet integral with additive CPM fuzzy measure. Optional params like **Cm**
- **Cml**: Choquet integral with fuzzy lambda measure version of CPM. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
- **Coifm**: Choquet integral with OIFM fuzzy measure. Optional params like **Cm**
- **Cg-isfm**: Choquet integral with global version of ISFM fuzzy measure. Optional params like **Cm**
- **Cd-isfm**: Choquet integral with dynamic version of ISFM fuzzy measure. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
- **Cg-mhm**: Choquet integral with global version of MHM fuzzy measure. Optional params like **Cm**
- **Cd-mhm**: Choquet integral with dynamic version of MHM fuzzy measure. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
- **Ceb**: Choquet integral with Entropy Based fuzzy measure
- **Sm**: Sugeno integral with CPM fuzzy measure. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
  - *pre_agg_function*: pre aggregation function to use. It can be 'min' (default), 'prod' or 'max'
- **Sm+**: Sugeno integral with additive CPM fuzzy measure. Optional params like **Sm**
- **Sml**: Sugeno integral with fuzzy lambda measure version of CPM. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
- **Soifm**: Sugeno integral with OIFM fuzzy measure. Optional params like **Sm**
- **Sg-isfm**: Sugeno integral with global version of ISFM fuzzy measure. Optional params like **Sm**
- **Sd-isfm**: Sugeno integral with dynamic version of ISFM fuzzy measure. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
- **Sg-mhm**: Sugeno integral with global version of MHM fuzzy measure. Optional params like **Sm**
- **Sd-mhm**: Sugeno integral with dynamic version of MHM fuzzy measure. Optional params:
  - *score*: score function to use for weight calculation. It can be accuracy ('acc'), mean of TPRs ('tpr'), geometric mean of TPRs ('gm'), F1 score ('f1'), ROC AUC ('auc') or Average Precision ('ap'). Default 'acc'
- **Seb**: Sugeno integral with Entropy Based fuzzy measure
